<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pl-export-excel</title>
    <script src="../dist/index.full.min.js"></script>
    <style>
      body {
        padding: 100px;
      }
      button {
        padding: 10px;
        font-size: 16px;
        color: #333;
      }
    </style>
  </head>
  <body>
    <div id="root">
      <p><button id="btn">点击导出 - 基础</button></p>
      <p><button id="btn2">点击导出 - 带标题</button></p>
      <p><button id="btn3">点击导出 - 多标题（携带合并 + 设置样式）</button></p>
    </div>
  </body>

  <!-- 基础示例 -->
  <script>
    var btn = document.getElementById("btn");
    btn.addEventListener("click", function () {
      const { exportJsonToExcel } = PlExportExcel;
      const headers = [
        { title: "经销商名称", key: "names" },
        { title: "下单时间", key: "date" },
        { title: "订单编号", key: "orderNumber" },
        { title: "客户名称", key: "customerName" }
      ];
      // 表格数据
      const datas = Array.from({ length: 200 }, (_, idx) => ({
        names: idx == 2 ? "大萨达萨达撒多少啊大" : "娃哈哈",
        age: (idx + 1) * 10,
        date: "201920120",
        orderNumber: idx + 1,
        customerName: "王小虎" + idx + 1
      }));
      exportJsonToExcel({ headers, datas });
    });
  </script>
  <!-- 带标题示例 -->
  <script>
    var btn2 = document.getElementById("btn2");
    btn2.addEventListener("click", function () {
      const { exportJsonToExcel } = PlExportExcel;
      // 表格数据
      const list = Array.from({ length: 200 }, (_, idx) => ({
        names: idx == 2 ? "大萨达萨达撒多少啊大" : "娃哈哈",
        date: "201920120",
        orderNumber: idx + 1,
        customerName: "王小虎" + idx + 1,
        orderState: "在线",
        orderPayState: "全付款",
        city: idx % 2 === 0 ? "上海" : "北京",
        address: idx % 2 === 0 ? "上海金沙江路200号" : "北京长安街1516号"
      }));
      exportJsonToExcel({
        headers: [
          { title: "经销商名称", key: "names" },
          { title: "下单时间", key: "date" },
          { title: "订单编号", key: "orderNumber" },
          { title: "客户名称", key: "customerName" },
          { title: "城市", key: "city" },
          { title: "地址", key: "address" }
        ],
        datas: list,
        filename: "11月订单表格",
        // 给电子表格设置一个标题
        titleConfig: {
          title: "11月订单表格",
          // 需要合并行数
          rowNum: 2
        }
      });
    });
  </script>
  <!-- 复杂版：多标题（携带合并 + 设置样式） -->
  <script>
    const btn3 = document.getElementById("btn3");
    btn3.addEventListener("click", function () {
      const { exportJsonToExcel } = PlExportExcel;
      // 表格数据
      const list = Array.from({ length: 10 }, (_, idx) => ({
        names: idx == 2 ? "大萨达萨达撒多少啊大" : "娃哈哈",
        date: "201920120",
        orderNumber: idx + 1,
        customerName: "王小虎" + idx + 1,
        city: idx % 2 === 0 ? "上海" : "北京",
        address: idx % 2 === 0 ? "上海金沙江路200号" : "北京长安街1516号"
      }));
      exportJsonToExcel({
        headers: [
          { title: "经销商名称", key: "names" },
          { title: "下单时间", key: "date" },
          { title: "订单编号", key: "orderNumber" },
          { title: "客户名称", key: "customerName" },
          { title: "城市", key: "city" },
          { title: "地址", key: "address" }
        ],
        datas: list,
        filename: "12月订单表格",
        // 多级头, 二维数组里面的每一个数组代表一行
        multiHeader: [
          ["标题1", "", "", "", "", ""],
          // 为了合并头，需要设置当前行的每一个单元格，属于占位单元格
          ["", "", "", "", "", ""],
          ["标题2", "", "", "", "", ""]
        ],
        // 合并多级头位一个单元
        merges: [
          {
            s: {
              //s为开始
              c: 0, //开始列, 0开始计算
              r: 0 //开始行, 0开始计算
            },
            e: {
              //e结束
              c: 5, //结束列, 0开始计算
              r: 1 //结束行, 0开始计算
            }
          },
          {
            s: {
              //s为开始
              c: 0, //开始列, 0开始计算
              r: 2 //开始行, 0开始计算
            },
            e: {
              //e结束
              c: 5, //结束列, 0开始计算
              r: 2 //结束行, 0开始计算
            }
          }
        ],
        // 自定义单元格样式
        styleCb: function (ws) {
          ws["A1"].s = {
            font: {
              name: "微软雅黑",
              sz: 16,
              color: { rgb: "CD0000" },
              bold: true,
              italic: false,
              underline: false
            },
            fill: {
              fgColor: { rgb: "AEEEEE" }
            }
          };
          ws["A3"].s = {
            font: {
              name: "微软雅黑",
              sz: 16,
              color: { rgb: "33ff99" }
            },
            fill: {
              fgColor: { rgb: "CD950C" }
            }
          };
        }
      });
    });
  </script>
</html>
